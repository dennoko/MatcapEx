# MatCapEx 使い方ガイド

lilToon拡張シェーダー「MatCapEx」の使い方を説明します。

## 概要

MatCapExは、lilToonに3つの独立したMatCapスロットを追加する拡張シェーダーです。
それぞれのスロットで異なるMatCapテクスチャやブレンドモードを設定できます。

## インストール

1. lilToonがプロジェクトにインストールされていることを確認
2. unitypackageをインポート
3. Unityがスクリプトを再コンパイルするのを待つ

## シェーダーの適用

1. マテリアルを選択
2. Shaderドロップダウンから `dennoko_matcapex > lilToon` を選択
3. マテリアルインスペクター下部の「MatCap 1st」「MatCap 2nd」「MatCap 3rd」を展開

描画モードは不透明、カットアウト、半透明に対応しています。

## パラメーター説明

### 基本設定

| パラメータ | 説明 |
|-----------|------|
| **Enable** | MatCapのON/OFF |
| **Texture** | MatCapテクスチャ（球体の画像） |
| **Color** | MatCapに乗算するカラー |
| **Main Color Strength** | メインテクスチャ色の影響度（0=無効、1=完全適用） |
| **Opacity** | MatCapの不透明度 |

### ブレンドモード

| モード | 効果 |
|--------|------|
| Add | 加算（明るくなる） |
| Screen | スクリーン（自然な明るさ） |
| Multiply | 乗算（暗くなる） |
| Overlay | オーバーレイ（コントラスト強調） |
| Soft Light | ソフトライト（穏やかな明暗） |
| Replace | 置換（MatCap色で上書き） |
| Subtract | 減算（暗くなる） |
| Lighten | 比較(明)（明るい方を採用） |
| Darken | 比較(暗)（暗い方を採用） |

### マスクとオプション

| パラメータ | 説明 |
|-----------|------|
| **Blur** | MatCapのぼかし（MipMap必要） |
| **Mask** | 適用範囲を制限するマスク（白=適用、黒=非適用） |
| **Normal Strength** | 法線マップの影響度 |
| **Use Reflection** | 視線反射モード（鏡面反射的な挙動） |
| **Disable on Backface** | 裏面でMatCapを無効化 |
| **Enable Lighting** | ライティング影響度（0=無効、1=完全適用） |
| **Shadow Strength** | 影部分でのMatCap減衰 |
| **Rim Power** | リムマスク（正=エッジ、負=中心、0=無効） |

### Use Reflection について

通常のMatCapは法線方向をそのまま使用しますが、**Use Reflection** をONにすると視線の反射ベクトルを使用します。

- **OFF（通常モード）**: カメラの向きに関係なく、法線に基づいた固定的なMatCap表示
- **ON（反射モード）**: カメラの向きによってMatCapの見え方が変化し、鏡面反射のような挙動

金属やガラスなど、視点によって反射が変化する表現に適しています。

### Rim Power について

Rim Powerは、MatCapの適用範囲をフレネル効果（視線角度）で制御します。

| 値 | 効果 |
|----|------|
| **0** | リムマスク無効（全体に均等適用） |
| **正の値** | エッジ（縁）に強く適用。値が大きいほど縁のみに集中 |
| **負の値** | 中心に強く適用。値の絶対値が大きいほど中心のみに集中 |

**使用例**
- `Rim Power = 1.5`: オブジェクトの縁にハイライトを追加
- `Rim Power = -1.5`: オブジェクトの正面にのみ効果を適用

## 描画モード

マテリアル上部の「Rendering Mode」から以下を選択できます：

- **Opaque** - 不透明
- **Cutout** - アルファテスト（切り抜き）
- **Transparent** - 半透明

## ライセンス

MIT License
